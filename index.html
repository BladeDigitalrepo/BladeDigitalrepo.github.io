<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hex Run Arcade v11</title>
  <style>
    body {
      margin: 0;
      background: black;
      color: white;
      font-family: monospace;
      overflow: hidden;
    }
    canvas {
      display: block;
      margin: auto;
      background: black;
      touch-action: none;
    }
    #controls {
      position: absolute;
      top: 420px;   /* just below canvas */
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 5;
    }
    .btn {
      background: black;
      border: 2px solid cyan;
      color: cyan;
      font-size: 16px;
      font-family: monospace;
      padding: 10px 20px;
      border-radius: 10px;
      text-align: center;
      user-select: none;
      cursor: pointer;
      box-shadow: 0 0 10px cyan;
    }
    .btn:active { background: cyan; color: black; }
    #btnRestart { display: none; border-color: magenta; color: magenta; box-shadow: 0 0 10px magenta; }
    #btnRestart:active { background: magenta; color: black; }
    #startScreen {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: black; color: cyan;
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      text-align: center; z-index: 10;
    }
    #startScreen h1 { font-size: 40px; text-shadow: 0 0 20px magenta, 0 0 10px cyan; }
    #startScreen pre { color: cyan; text-shadow: 0 0 5px cyan; }
    #btnStart {
      margin-top: 20px; background: black; border: 2px solid magenta; color: magenta;
      padding: 10px 30px; font-size: 20px; font-family: monospace; border-radius: 10px;
      cursor: pointer; box-shadow: 0 0 10px magenta;
    }
    #btnStart:active { background: magenta; color: black; }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="800" height="400"></canvas>

  <!-- Arcade Start Screen -->
  <div id="startScreen">
    <h1>HEX RUN ARCADE</h1>
    <pre>
     /\_/\
    ‚ö°=^.^=
    </pre>
    <button id="btnStart">‚ñ∂ START</button>
  </div>

  <!-- Touch controls -->
  <div id="controls">
    <div class="btn" id="btnLeft">‚¨ÖÔ∏è</div>
    <div class="btn" id="btnJump">‚§¥Ô∏è JUMP</div>
    <div class="btn" id="btnRight">‚û°Ô∏è</div>
    <div class="btn" id="btnPause">‚è∏Ô∏è</div>
    <div class="btn" id="btnRestart">üîÑ Restart</div>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    // üîä Sounds
    const jumpSound = new Audio("https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg");
    const scoreSound = new Audio("https://actions.google.com/sounds/v1/cartoon/slide_whistle_to_drum.ogg");
    const crashSound = new Audio("https://actions.google.com/sounds/v1/cartoon/concussive_drum_hit.ogg");
    const bgMusic = new Audio("https://vgmsite.com/soundtracks/pokemon-gameboy-sound-collection/jhbtfxzdfp/101%20-%20Opening.mp3");
    bgMusic.loop = true; bgMusic.volume = 0.4;

    function playSound(audio) {
      audio.currentTime = 0;
      audio.play().catch(e => console.log("Audio blocked:", e));
    }

    // Game state
    let running = false, paused = false;
    let speed = 4, gravity = 0.6, jumpStrength = -12, score = 0;

    // Player
    const player = { x: 100, y: 300, dy: 0, jumping: false };

    // Obstacles & drones
    const obstacles = [], drones = [];
    let droneCooldown = 0;

    // Stars
    const stars = [];
    for (let i = 0; i < 100; i++) stars.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, r: Math.random()*2 });

    // Skyline
    const skyline = [];
    function generateSkyline() {
      let x = 0;
      while (x < canvas.width + 100) {
        let w = 40 + Math.random()*30;
        let h = 80 + Math.random()*120;
        skyline.push({ x, w, h });
        x += w;
      }
    }
    generateSkyline();

    // üêæ Cyber Cat frames
    const catFrames = [
      ["   /\\_/\\ ", "‚ö°Ô∏è„Ää=^.^=)", "   /|_|\\ ", "   / | \\"],
      ["   /\\_/\\ ", "‚ö°Ô∏è„Ää=^.^=)", "   /|_|\\ ", "   /   \\"]
    ];
    let frameIndex = 0, frameCounter = 0;

    function drawCat(x, y) {
      ctx.shadowBlur = 15; ctx.shadowColor = "cyan"; ctx.fillStyle = "cyan"; ctx.font = "16px monospace";
      frameCounter++;
      if (frameCounter % 10 === 0) frameIndex = (frameIndex + 1) % catFrames.length;
      const lines = catFrames[frameIndex];
      for (let i = 0; i < lines.length; i++) ctx.fillText(lines[i], x, y + i*16);
      ctx.shadowBlur = 0;
    }

    // Jump
    function jump() {
      if (!player.jumping && running && !paused) {
        player.dy = jumpStrength; player.jumping = true; playSound(jumpSound);
      }
    }

    // Controls
    document.getElementById("btnJump").addEventListener("click", jump);
    document.getElementById("btnLeft").addEventListener("click", () => { if (speed > 1) speed -= 1; });
    document.getElementById("btnRight").addEventListener("click", () => { speed += 1; });
    document.getElementById("btnPause").addEventListener("click", () => {
      paused = !paused; if (paused) bgMusic.pause(); else playSound(bgMusic);
    });
    document.getElementById("btnRestart").addEventListener("click", () => { resetGame(); bgMusic.play(); });

    document.getElementById("btnStart").addEventListener("click", () => {
      document.getElementById("startScreen").style.display = "none";
      resetGame(); running = true; playSound(bgMusic); gameLoop();
    });

    // Reset
    function resetGame() {
      obstacles.length = 0; drones.length = 0; skyline.length = 0; generateSkyline();
      score = 0; speed = 4; player.y = 300; player.dy = 0; player.jumping = false;
      running = true; paused = false; document.getElementById("btnRestart").style.display = "none";
    }

    // Update
    function update() {
      if (paused) return;

      // Physics
      player.y += player.dy; player.dy += gravity;
      if (player.y > 300) { player.y = 300; player.dy = 0; player.jumping = false; }

      // Obstacles
      obstacles.forEach(o => o.x -= speed);
      if (obstacles.length && obstacles[0].x + 20 < 0) { obstacles.shift(); score++; playSound(scoreSound); }

      // Drones
      drones.forEach(d => d.x -= speed);
      if (drones.length && drones[0].x + 20 < 0) { drones.shift(); score++; playSound(scoreSound); }

      // Collision
      [...obstacles, ...drones].forEach(obj => {
        if (player.x < obj.x + 20 && player.x + 40 > obj.x && player.y < obj.y + 20 && player.y + 40 > obj.y) {
          running = false; playSound(crashSound); bgMusic.pause(); document.getElementById("btnRestart").style.display = "block";
        }
      });

      // Random spawns
      if (Math.random() < 0.02) obstacles.push({ x: canvas.width, y: 320 });
      if (droneCooldown <= 0 && Math.random() < 0.02) {
        drones.push({ x: canvas.width, y: 200 + Math.random()*100 - 50 });
        droneCooldown = 200;
      } else { droneCooldown--; }

      // Skyline scroll
      skyline.forEach(b => b.x -= speed*0.5);
      if (skyline.length && skyline[0].x + skyline[0].w < 0) {
        let lastX = skyline[skyline.length-1].x + skyline[skyline.length-1].w;
        let w = 40 + Math.random()*30, h = 80 + Math.random()*120;
        skyline.shift(); skyline.push({ x:lastX, w, h });
      }

      // Difficulty
      if (score % 10 === 0 && score !== 0 && speed < 12) speed += 0.02;
    }

    // Draw skyline
    function drawSkyline() {
      ctx.shadowBlur = 15; ctx.shadowColor = "magenta"; ctx.fillStyle = "#111";
      skyline.forEach(b => { ctx.fillRect(b.x, canvas.height-b.h-60, b.w, b.h); ctx.strokeStyle="magenta"; ctx.strokeRect(b.x, canvas.height-b.h-60, b.w, b.h); });
      ctx.shadowBlur = 0;
    }

    // Draw all
    function draw() {
      ctx.clearRect(0,0,canvas.width,canvas.height);

      // Stars
      ctx.fillStyle = "white";
      stars.forEach(s => { ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fill(); s.x -= 0.2; if(s.x<0) s.x = canvas.width; });

      drawSkyline();
      ctx.fillStyle = "lime"; ctx.fillRect(0,340,canvas.width,5);
      drawCat(player.x, player.y);

      ctx.shadowBlur = 10; ctx.shadowColor="red"; ctx.fillStyle="red";
      obstacles.forEach(o => ctx.fillRect(o.x,o.y,20,40)); ctx.shadowBlur=0;

      ctx.shadowBlur = 10; ctx.shadowColor="orange"; ctx.fillStyle="orange";
      drones.forEach(d => { ctx.beginPath(); ctx.arc(d.x+10,d.y+10,10,0,Math.PI*2); ctx.fill(); }); ctx.shadowBlur=0;

      ctx.fillStyle="white"; ctx.font="16px monospace";
      ctx.fillText("Score: "+score,10,20); ctx.fillText("Speed: "+speed.toFixed(1),10,40);

      if (!running) {
        ctx.fillStyle="white"; ctx.font="24px monospace";
        ctx.fillText("üíÄ GAME OVER üíÄ",canvas.width/2-100,canvas.height/2);
        ctx.fillText("Final Score: "+score,canvas.width/2-90,canvas.height/2+40);
      }
      if (paused && running) {
        ctx.fillStyle="white"; ctx.font="20px monospace";
        ctx.fillText("‚è∏ PAUSED",canvas.width/2-50,canvas.height/2);
      }
    }

    // Loop
    function gameLoop() {
      if (!running) { draw(); return; }
      update(); draw(); requestAnimationFrame(gameLoop);
    }
  </script>
</body>
</html>
